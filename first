# Next week flag (Mon–Sun, London)
  dimension: happens_next_week_monday_sunday {
    group_label: "London Time – Next Week (Happens)"
    type: yesno
    sql:
    DATE(${appt_happen_ldn_raw}) BETWEEN
      DATE_TRUNC(CURRENT_DATE("Europe/London"), WEEK(MONDAY)) + 7
      AND
      DATE_TRUNC(CURRENT_DATE("Europe/London"), WEEK(MONDAY)) + 13 ;;
  }



dimension_group: cancel_time {
    group_label: "Data – Dimensions-London_Time"
    type: time
    sql: TIMESTAMP(DATETIME(${TABLE}.updated_at, "Europe/London")) ;;
    timeframes: [raw, date, day_of_week, day_of_week_index, hour_of_day, week, month]
  }


measure: pct_booked_30_days_vs_year_london {
    group_label: "London Time – Summary"
    label: "% Booked (Last 30 Days vs This Year – London)"
    type: number
    value_format_name: percent_1
    sql: SAFE_DIVIDE(${appts_booked_last_30_days_london}, NULLIF(${appts_booked_this_year_london}, 0)) ;;
  }
